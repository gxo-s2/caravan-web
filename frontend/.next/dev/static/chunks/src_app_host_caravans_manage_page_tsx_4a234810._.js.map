{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/snoo/caravan-app/frontend/src/app/host/caravans/manage/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Link from 'next/link';\nimport { useRouter } from 'next/navigation';\n\n// --- 타입 정의 ---\ninterface Caravan {\n  id: string;\n  name: string;\n  pricePerDay: number;\n  location: string;\n}\n\ninterface User {\n  id: string;\n  role: 'HOST' | 'GUEST';\n}\n\nexport default function ManageCaravansPage() {\n  const [caravans, setCaravans] = useState<Caravan[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [user, setUser] = useState<User | null>(null);\n  const [processingId, setProcessingId] = useState<string | null>(null); // 삭제 처리 중인 ID\n  const router = useRouter();\n\n  // 1. 사용자 정보 로드 및 호스트 여부 확인\n  useEffect(() => {\n    const storedUser = localStorage.getItem('user');\n    if (storedUser) {\n      const parsedUser = JSON.parse(storedUser);\n      if (parsedUser.role !== 'HOST') {\n        alert('호스트만 접근할 수 있는 페이지입니다.');\n        router.push('/');\n      } else {\n        setUser(parsedUser);\n      }\n    } else {\n      alert('로그인이 필요합니다.');\n      router.push('/auth/login');\n    }\n  }, [router]);\n\n  // 2. 호스트의 카라반 목록 불러오기\n  useEffect(() => {\n    if (user?.id) {\n      const fetchCaravans = async () => {\n        setLoading(true);\n        try {\n          const response = await axios.get(`https://caravan-app-api.onrender.com/api/caravans/host/${user.id}`);\n          setCaravans(response.data);\n          setError(null);\n        } catch (err) {\n          console.error(\"카라반 목록 로딩 실패:\", err);\n          setError('카라반 목록을 불러오는 데 실패했습니다.');\n        } finally {\n          setLoading(false);\n        }\n      };\n      fetchCaravans();\n    }\n  }, [user]);\n\n  // 3. 카라반 삭제 핸들러\n  const handleDelete = async (caravanId: string) => {\n    if (!confirm(\"정말로 이 카라반을 삭제하시겠습니까?\\n이 작업은 되돌릴 수 없습니다.\")) return;\n\n    setProcessingId(caravanId);\n    try {\n      await axios.delete(`https://caravan-app-api.onrender.com/api/caravans/${caravanId}`);\n      alert('카라반이 성공적으로 삭제되었습니다.');\n      // 삭제 성공 시 목록에서 해당 아이템 제거하여 UI 업데이트\n      setCaravans(prev => prev.filter(c => c.id !== caravanId));\n    } catch (err: any) {\n      console.error(\"카라반 삭제 실패:\", err);\n      alert(err.response?.data?.message || '카라반 삭제 중 오류가 발생했습니다.');\n    } finally {\n      setProcessingId(null);\n    }\n  };\n\n  if (!user) {\n    return <div className=\"p-6 text-center\">사용자 정보를 불러오는 중...</div>;\n  }\n  \n  return (\n    <div className=\"max-w-7xl mx-auto p-4 sm:p-6 lg:p-8\">\n      <div className=\"flex justify-between items-center mb-8\">\n        <h1 className=\"text-3xl font-bold text-gray-800\">내 카라반 관리</h1>\n        <Link href=\"/caravans/new\" className=\"px-5 py-2.5 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition-all\">\n          + 새 카라반 등록\n        </Link>\n      </div>\n\n      <div className=\"bg-white rounded-xl shadow-sm border\">\n        {loading ? (\n          <p className=\"p-6 text-center text-gray-500\">카라반 목록을 불러오는 중...</p>\n        ) : error ? (\n           <p className=\"p-6 text-center text-red-500\">{error}</p>\n        ) : caravans.length === 0 ? (\n          <div className=\"p-10 text-center\">\n            <p className=\"text-gray-500\">아직 등록된 카라반이 없습니다.</p>\n            <p className=\"text-sm text-gray-400 mt-2\">위의 '새 카라반 등록' 버튼을 눌러 시작해보세요!</p>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm text-left text-gray-600\">\n              <thead className=\"text-xs text-gray-700 uppercase bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-4\">이름</th>\n                  <th className=\"px-6 py-4\">위치</th>\n                  <th className=\"px-6 py-4\">가격 (1박)</th>\n                  <th className=\"px-6 py-4 text-right\">관리</th>\n                </tr>\n              </thead>\n              <tbody>\n                {caravans.map(caravan => (\n                  <tr key={caravan.id} className=\"bg-white border-b hover:bg-gray-50\">\n                    <td className=\"px-6 py-4 font-medium text-gray-900 whitespace-nowrap\">{caravan.name}</td>\n                    <td className=\"px-6 py-4\">{caravan.location}</td>\n                    <td className=\"px-6 py-4\">₩{caravan.pricePerDay.toLocaleString()}</td>\n                    <td className=\"px-6 py-4 text-right space-x-4\">\n                      <Link href={`/caravans/edit/${caravan.id}`} className=\"font-medium text-blue-600 hover:text-blue-800 hover:underline\">\n                        수정\n                      </Link>\n                      <button\n                        onClick={() => handleDelete(caravan.id)}\n                        disabled={processingId === caravan.id}\n                        className=\"font-medium text-red-600 hover:text-red-800 hover:underline disabled:text-gray-400 disabled:cursor-wait\"\n                      >\n                        {processingId === caravan.id ? '삭제 중...' : '삭제'}\n                      </button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}